<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="team3.promans.interfaces.SelectInterface">
	<!-- 내 업무 조회 -->
	<select id="getMySchedule" parameterType="team3.promans.beans.ScheduleDetailBean"
	resultType="team3.promans.beans.ScheduleDetailBean">
		SELECT
		SD_USERID as userid,
		SD_CODE as sdcode,
		SD_NAME as sdname,
		SD_TITLE as sdcontent,
		SD_DATE as sddate 
		FROM SD
		WHERE SD_CPCODE= #{cpcode} and
		SD_PRCODE= #{prcode} and
		SD_PSCODE= #{pscode} and
		SD_USERID= #{userid}
	</select>

	<!-- 업무 일지 조회 -->
	<select id="getDiary" parameterType="team3.promans.beans.WorkDiaryBean" 
	resultType="team3.promans.beans.WorkDiaryBean">
		SELECT WD_CPCODE as cpcode,
		WD_PRCODE as prcode,
		WD_USERID as userid,
		WD_CODE as wdcode,
		WD_TITLE as wdtitle,
		WD_CONTENTS as wdcontents,
		WD_DATE as wddate
		FROM WD
		WHERE WD_CPCODE = #{cpcode}
		and WD_PRCODE = #{prcode}
		and WD_USERID = #{userid} 
		
	</select>

	<select id="getNoticeList"
		parameterType="team3.promans.beans.Notice_CalendarBean"
		resultType="team3.promans.beans.Notice_CalendarBean">
		SELECT NO_USERID as writer,
		NO_TITLE as title,
		NO_CONTENTS as contents,
		NO_DATE as sdate,
		NO_FILEPATH as filepath,
		NO_FNAME as fname
		FROM PNT
		WHERE NO_CPCODE = #{cpcode} and NO_USERID = #{writer}
	</select>

	<select id="getProject"
		parameterType="team3.promans.beans.ProjectMemberBean"
		resultType="team3.promans.beans.ProjectBean">

		SELECT CPCODE, PRCODE, PRNAME, PROPEN, TO_CHAR(PRDATE,'YYYY-MM-dd') AS
		PRDATE FROM PROJECTVIEW WHERE USERID = #{userid} AND CPCODE =
		#{cpcode}

	</select>

	<select id="getProjectStep"
		parameterType="team3.promans.beans.ProjectMemberBean"
		resultType="team3.promans.beans.ProjectStepBean">

		SELECT PSNAME,STNAME,PSCODE FROM PROJECTVIEW WHERE CPCODE = #{cpcode} AND
		PRCODE = #{prcode}

	</select>

	<select id="selectSchedule"
		parameterType="team3.promans.beans.ProjectStepBean"
		resultType="team3.promans.beans.ScheduleBean">
		SELECT SCCODE, SCNAME, SCSTCODE, SCSTATE, PSCODE FROM SCHEDULEVIEW WHERE
		CPCODE = #{cpcode} AND PRCODE = #{prcode} AND PSCODE = #{pscode}
	</select>

	<select id="getScheDetail"
		parameterType="team3.promans.beans.ScheduleDetailBean"
		resultType="team3.promans.beans.ScheduleDetailBean">
		SELECT
		SD.SD_CODE AS SDCODE,
		SD.SD_NAME AS SDNAME,
		SD.SD_TITLE AS SDCONTENT,
		TO_CHAR(SD.SD_DATE, 'YYYY-MM-dd') AS SDDATE,
		ST.ST_CODE AS SDDCODE,
		ST.ST_NAME AS SDDSTATE,
		CM.CM_UNAME AS USERNAME,
		SD.SD_USERID AS USERID
		FROM SD INNER JOIN ST ON SD.SD_STATE = ST.ST_CODE
		INNER JOIN CM ON SD.SD_CPCODE = CM.CM_CPCODE AND SD.SD_USERID =
		CM.CM_USERID
		WHERE SD.SD_CPCODE = #{cpcode} AND SD.SD_PRCODE = #{prcode} AND
		SD.SD_PSCODE = #{pscode} AND SD.SD_SCCODE = #{sccode} AND SD.SD_USERID
		= #{userid}
	</select>
	
</mapper>